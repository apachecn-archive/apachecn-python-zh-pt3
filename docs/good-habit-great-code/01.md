# 1.编码幻想

很久很久以前，一个有才华的年轻程序员没有资源去寻求更多的教育。他的工作没有前途，永远不会有任何提升。此外，他的家人也帮不了他，他住在镇上一个破败、不安全的地方。我们的程序员有四个开发了类似编程技能的朋友，他们也感到受到了机会的限制。他们都有点沮丧，担心自己的未来。

突然，五个程序员发现了一个惊人的机会。如果他们可以组队编写一个特定的计算机应用程序，那么他们将得到的关注将立即为更好的工作打开大门。

当然，在这种情况下，任何人都想尝试编写应用程序。但事情没那么简单。以前，他们每个人编写的最具挑战性的程序需要三周时间，每天 1-2 小时。大部分时间都花在了调试上。其中一些错误很难追踪，以至于他们两次放弃了他们的程序，只是出于好奇才回来找他们。事实上，那三周的时间实际上分散在六周内。他们都有同样的经历。

在回顾这个新项目的工作时，似乎这项工作自然可以分成五个相等的部分。问题是每一部分都比他们任何一个人以前做过的任何东西都长五倍。他们有 40 周的时间来完成这个项目。理论上，如果所有人都能保持专注，那就有足够的时间来完成。但实际上，其复杂性超出了任何人的想象。诱人的奖品也是对失败的邀请。简而言之，每个人都认为，他们目前过的这种无处可去的平静生活，可能比几乎肯定会导致失败的 40 周痛苦生活要好。谁需要那个？也许会有别的事情发生。最终，在交谈中，这五个朋友意识到这种失败主义思想是人们无法从生活中的贫困处境中爬出来的一个常见原因。然而，就每个人目前对这个项目的理解而言，完成这个项目对他们来说太难了。如果他们能增加成功的可能性，那么这也许值得一试。那么，该怎么办呢？

首先，这五个程序员必须接受这样一个事实:他们必须把自己变成编程机器人。他们日常生活中的许多乐趣将不得不被数小时的编码所取代。这需要改变习惯和对生活的看法。他们能做到吗？摆在他们面前的奖品可能就足够了。

真正的问题是调试。尽管代码的所有部分看起来都足够合理，但是有太多的部分会导致调试问题大量出现。他们不知道他们中的任何一个人是如何成功的。然后有人提出了一个解决方案:对于几乎每个编写的关键函数，可以编写一个配套函数来测试该函数。在每一次编码之后，测试功能将被运行。另一个程序将导入大多数重要的函数，并通过每个函数运行几组数据。例如，数据将测试函数中几乎所有的 if 语句。

这意味着，如果发生重新设计，受到不利影响的功能将立即被标记出来。为应用程序中需要的每一个函数编写两个函数将是额外的工作，但是测试函数将很容易编写，并且彼此非常相似。这个被称为单元测试的方案似乎带来了希望。

另一个成员建议团队每周聚在一起阅读彼此的代码，讨论问题，并提出新的解决方案。在这些代码评审中，他们会分享问题和艰难获得的解决方案。另一个建议是用英文描述(docstrings)记录几乎每一个关键函数，以便其他成员可以更容易地理解代码。另一个建议是，他们应该偶尔尝试成对工作(结对编程):一个打字，另一个思考正在键入什么。

该小组认为，他们成功的唯一机会是通过这些公约。其中一名成员后来描述说，使用这些约定就像穿着紧身衣写代码一样。

编码开始后不久，成员们注意到进展缓慢但稳定。不可避免的重新设计，通常基于被忽略的特殊情况和选择不当的数据结构，几乎总是会引起其他变化的多米诺骨牌效应。单元测试很快发现并定位了这些变化。

成员们也开始讨论编码风格的细微差别——例如，是否应该写

```
if (x and y) == True: print(x)

```

或者

```
if x and y: print(x)?

```

因为意见不一，他们决定以团体风格投票，坚持团体的决定。最终，他们的惯例，通常是武断的，开始看起来正确，任何不同的惯例看起来都是错误的。因为每个人都使用相同的风格，所以他们在阅读以他们商店风格编写的代码时都变得很有效率。

长话短说，他们的牺牲、承诺和关于编写代码的正确决策使他们能够完成项目并赢得更好的生活。最终，他们被寻找专业程序员的雇主雇用了。

他们的新雇主欣赏这个团队的成员有几个原因。首先，程序员将他们的生命投入到编写代码中，他们的技能非常优秀。他们写代码很快，而且几乎没有错误。他们理解他们的语言，并有效地使用其结构。第二，同样重要的是，他们的代码很容易被其他人阅读。第三，他们很灵活。他们在编码中采用了当前的 house 风格，即使他们个人更喜欢以不同的方式编写代码。

在这些编码员工作的一些公司，有裁员。我们的五个原编码员从未被放过。正如一位雇主所说，“他们给的总是比期望的多。谁会让这样的员工离开呢？”

几年过去了，他们都退出了写代码的行业。其中一个年轻的程序员有点无聊。他怀念编码的经历，但年纪太大了，无法重返全职工作。他的配偶注意到邻近的高中需要一名兼职教师来教授一个学期的高级编程课程。他接受了这份工作。

以前的老师希望学生理解不同的算法，并通过在计算机代码中正确实现算法来培养他们的编程技能。这位由程序员转行的老教师同意了这一观点，并意识到商业成功所必需的许多惯例不适用于编写小程序的学生。尽管如此，他认为，编写可读的代码应该与算法、语言指令和数据结构一起教授。课程进行到一半时，他已经讲课并张贴了以下准则。

## 开发程序员的建议(疼痛管理)

1.  将功能局限于单个任务，或者简单且高度相关的任务(内聚与耦合)。
2.  标记并对齐您的输出。
3.  在顶部记录你的项目:名称、日期、课时(可能是课程和讲师)、标题和项目描述。注意你的拼写、语法和标点。
4.  用行号编码，不要少于三个空格。
5.  如果要强调重要的关系，请在代码中使用垂直对齐。
6.  不要使用 Python 语言名称(保留字和内置名称)作为标识符或文件名，例如`random`、`max`、`print`、`factorial`等。
7.  在程序变得更具可读性之后，对其进行重构。这就是学习程序设计的时间和方式。
8.  使用逐步细化:概述程序工作的函数调用。将`main()`函数限制为调用其他函数。在短程序中，你可以给`main`函数添加初始化和一些输出行。
9.  编写自文档化的代码(描述性标识符，通常是动词对象函数名)，从而最大限度地减少注释。避免过度缩写标识符，以节省键入几个字母。
10.  总是打印每个程序的运行时间，也许还有其他一些统计数据。
11.  避免使用神奇的数字，除非它们能使代码变得非常简单。
12.  避免全局变量，但是全局常量是可以接受的。
13.  不要写聪明的代码(代码看起来不像它做的那样)，简单的代码就可以了。
14.  选择可读性，而不是速度优化和内存使用优化。
15.  通过使用防御措施(断言、错误陷阱、`try/except`块和中间打印)来预测 bug。只是不要过度。
16.  完成后测试每个关键功能。将未测试的代码视为损坏的代码。
17.  对于复杂的算法，可以考虑在编写代码之前编写一些简单的测试，而不是在编写代码之后。* * *
18.  在完成前一项任务或职能之前，不要开始下一项任务或职能。
19.  编码时，你需要全神贯注。避开健谈的同学。(有时候孤立自己的目的是逼你自己解决问题。不要依赖你的同学。)
20.  将每个作业保存在至少两个不同的物理设备上。* * *
21.  每周写点代码。不要退步。你可能要逼自己。
22.  花时间和聪明人在一起，试着让他们谈谈工作。
23.  看其他程序员的代码。
24.  自学编程工具:复杂的编辑器、语言习惯用法和技巧、内置函数和数据结构。
25.  带着尝试挑战性问题的历史来解决你的问题。
26.  努力避免作弊。
27.  不要让成绩和课外活动破坏你的教育。你要对自己的学习负责，而不是学校。

不幸的是，这份名单不仅被忽视，还被学生们质疑。他无意中听到许多贬低的评论:

*   “我不明白为什么我的代码对别人来说是可读的，而对我来说却是可读的，没有人会去读它。让程序运行已经够难了。我需要时间上其他课。”
*   “我不敢相信他要求我们不要写聪明的代码。他是想扼杀我们吗？”
*   “我认为我的代码足够具有描述性。他太挑剔了，要求更好的描述。”
*   “其他的 C.S .老师没有这么挑剔。我希望我在她的班上。”
*   “我的代码和保罗的完全一样，因为我们一起工作。他总是说我们需要互相帮助。他最好别说我作弊。”
*   “他告诉我们要互相帮助，而不是寻求帮助。这毫无意义。”
*   “我的程序中没有错误，那么他为什么要我在代码中设置错误陷阱呢？”
*   “我的代码适用于我的输入。这对他的输入不起作用，因为他用奇怪的数据进行测试，比如空集。”
*   "我仍然不明白关注分数会对我的教育产生什么负面影响。"
*   “为什么我们要在自己的时间里学习工具？他不应该把它们教给我们吗？”
*   “互联网上有很多程序不遵守他的规则。那么，他以为自己是谁？”

这位老程序员足够敏感，最终意识到课堂气氛已经从热情转为厌恶。因此，他改变了他的优先事项。只有少数短节目会被检查风格。其他人如果工作的话会被接受。作业变得更短更容易。他表扬了学生们简单的成功。他用一个有趣的 YouTube 视频开始了大多数课程，并允许热烈的讨论继续进行，即使他们抢了全班的练习时间。最后，学生们惊讶于老师进步了这么多。几个学生给了老师临别赠言和小礼物。

就在学年结束前，他反思了所发生的事情。他试图传递给学生的想法、习惯和观点超出了他们的理解范围。他们很快就能捕捉到细节，但没有足够的成熟度或动机去欣赏任何形式的大局。多年前，他和他的朋友们被绝望逼得不得不改变自己。教授他们这种元思维不能通过谈话来完成。它必须以某种方式经历才会被相信。然而，他给他们留下了一个警告。他给他们讲了下面的故事。

The Old Programmer’s Story

同学们，昨晚我发生了一件很神奇的事情，我想和大家分享一下。我与上帝交谈。是的，没错，上帝眷顾了我。诚然，他在梦中来找我，但我知道那是上帝。我们谈到了你的未来。不是对你们所有人，而是对很多人。我想告诉你你的未来会怎样。你的未来会很美好。你要去上大学，毕业，找一份好工作。在你遇到你的另一半之前，你会有很多有趣的假期和冒险。你会有一栋漂亮的房子，享受你的工作，有几个好孩子，还有健康的身体。你将拥有每个人都想拥有的未来。我想我应该现在就告诉你，趁你还年轻，你的未来会有多美好——至少到 45 岁左右。

那时你将被解雇。不是因为你做错了什么。这只是商业的变化和合并。就业部门在不断变化。因为你在你的职业中不突出，你被解雇了。

很自然，你试图找到另一份工作。毕竟，你有多年的经验。不幸的是，编码公司更喜欢雇佣年轻的程序员，他们不必支付那么多工资。不同的管理层认为，几年后，年轻的程序员会有和老程序员一样多的经验。年轻的程序员可能会成为伟大的程序员，而你只是一个普通的程序员。所以你参加了许多面试，但从未得到工作机会。这意味着你的配偶在支撑这个家庭。你大部分时间呆在家里做家务。假期被取消，孩子们的夏令营被取消，电子设备无法升级，当主电视坏了，你的家人把小电视从书房搬到了客厅。你花在自己身上的任何钱都会立即被注意到并受到严厉的批评。当你的配偶和你结婚时，他/她并没有预料到这种简朴的生活方式。怨恨导致了争论。你的配偶在孩子们面前批评你，孩子们也开始对你失去尊重。你的家庭关系变得有毒。最后，你的配偶提出离婚，要求你搬出去。

在离婚时，你从你们的共同储蓄中得到一些钱来买房子，但是你的配偶得到了孩子——你不能抚养他们。最终，你的钱花光了，你最后做了一份清洁工的工作，只是为了支付你的房租和食物。你开始变得沮丧，并开始从廉价的酒精快感中获得安慰。你没有变成酒鬼，但你每天都喝酒。几年后，你偶然照了照镜子，发现自己看起来比实际年龄要老。你掉了一颗牙，又没钱去替换它。你抬头看着天花板说，“为什么这一切会发生在我身上？我做了什么才落得如此下场？”突然，你听到身后有声音，注意到镜子里有动静。你转过身，你猜怎么着，你碰巧看到了我，你以前的计算机科学老师。

“s 先生，我以为你几年前就去世了。你在这里干什么？”

“我几年前就死了。但现在我成了宇宙力量的工具。我是来帮你摆脱困境的。”

“我不敢相信我的运气，”你说。“你要给我找份好工作，让我养家糊口，找回自尊吗？”

“不，宇宙力量不是那样运作的。”

“那你打算给我钱吗？”

“不，宇宙力量也不是那样运作的。”

“嗯然后呢？你打算怎么帮我？”

“首先，我想告诉你，你是如何让自己陷入这种困境的。你因平庸而犯罪。你从未脱颖而出。你没有学习超过你所需要的。你只做了要求的最少部分。你没有努力学习新技能。你没有努力提高你目前的技能，因为你没有必要这样做。当潜在雇主给你的前雇主打电话时，管理层所能做的就是核实你以前的工作。他们对你没什么好评价。难怪你第一个被解雇，最后一个被重新雇用。一旦你明白了这一点，就有希望成功”

“好吧，”你说。“这似乎是真的。在我看来，我从没想过我的未来会变成这样。我以为一般就够好了。除了工作，我还有其他爱好。我不想成为一个工作狂。不过，好吧，我已经吸取教训了。只要让我离开这种生活。”

“你吸取教训了吗？我们会找到答案的。我要让时间倒流，把你送回你在我班上的时候。你会忘记你的未来，除了我现在告诉你的这个关于你生活的小故事。我就像圣诞未来的幽灵。未来不是固定的，否则我不会告诉你这些。你的警告是要比平均水平更好。总是继续学习更多，提高自己的技能。无论是在工作中还是在人际关系中，总是付出比期望的更多。然而，要知道:你不会再有机会了。祝你好运。”

学生们认为这个故事很可爱，他们很欣赏一个能让他们开心的老师。他们中的大多数人很快就忘记了这个故事。只有少数人对此感到困扰。对他们来说，这个故事支持了他们已经开始相信的事情:可怕的陷阱在他们的未来——工作中的陷阱，婚姻中的陷阱，甚至是他们最终试图保护的孩子的陷阱。他从来不知道，但老程序员已经为他的学生做了所有可能的事情。